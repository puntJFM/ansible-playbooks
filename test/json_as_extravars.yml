---
- name: Debug JSON custom_vars
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Print all available variables
      debug:
        var: vars

    - name: Print raw custom_vars (before conversion)
      debug:
        var: custom_vars
      when: custom_vars is defined

    - name: Convert custom_vars from string to JSON
      set_fact:
        custom_vars_dict: "{{ custom_vars | from_json if custom_vars is string else custom_vars | default({}) }}"
      when: custom_vars is defined

    - name: Print parsed custom_vars_dict
      debug:
        var: custom_vars_dict
      when: custom_vars_dict is defined
